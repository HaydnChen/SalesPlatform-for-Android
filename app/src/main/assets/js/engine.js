!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("lodash"),require("moment")):"function"==typeof define&&define.amd?define(["lodash","moment"],e):"object"==typeof exports?exports.engine=e(require("lodash"),require("moment")):t.engine=e(t.lodash,t.moment)}(this,function(e,a){return function(t){function e(r){if(a[r])return a[r].exports;var n=a[r]={exports:{},id:r,loaded:!1};return t[r].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var a={};return e.m=t,e.c=a,e.p="",e(0)}([function(t,e,a){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e["default"]=t,e}var n=a(4),u=r(n);console.log("Offline engine at exported at....",new Date),t.exports=u},function(t,a){t.exports=e},function(t,e){t.exports=a},function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function n(){return(0,c["default"])()}function u(t,e){var a=n(),r=c["default"].isMoment(e)?e:i(e);f["default"].has(r,"isValid")||(r=(0,c["default"])(r));var u=r.month()===a.month()&&r.day()===a.day()?!0:!1,l=a.diff(r,"years");return"ANB"===t?l=u?l:l+1:"ALAB"===t?l=u?l-1:l:(age1=a.diff(r,"years",!0),l=age1-l>.5?l:l+1),l}function i(t){var e=(0,c["default"])(t,["D-M-YYYY","YYYY-M-D","YYYY-M-D HH:mm","YYYY-M-D HH:mm:ss","D-M-YY HH:mm:ss","D-M-YY HH:mm"],!0);return e.isValid()?e:f["default"].isDate(t)?(0,c["default"])(t):null}function l(t,e){var a={};return f["default"].zip(t,e).forEach(function(t,e){var r=_(t,2),n=r[0],u=r[1];a[n]=u,10>e&&(a[e]=u)}),a}function o(t,e){var a=t+1e-15;return parseFloat(a.toFixed(e))}function d(t,e,a){var r=arguments.length<=3||void 0===arguments[3]?!0:arguments[3],n=e._keys,u=[];return n.forEach(function(n){var i=_(n,2),l=i[0],o=i[1],d=a[l],s="_key_"+l,m=e[s],v=!1;if(1===m.length&&(f["default"].isUndefined(d)||f["default"].isNull(d)))u.push(m[0][0]);else{for(var c=0;c<m.length;c++){var g=m[c],p=_(g,2),h=p[0],y=p[1],b=h,w=y;if("int"===o?(b=parseInt(b),w="*"===w?w:parseInt(w),d=parseInt(d)):"number"===o?(b=parseFloat(b),w="*"===w?w:parseFloat(w),d=parseFloat(d)):"str"===o&&"string"!=typeof d&&(d=""+d),"*"===w){if(d===b){u.push(h),v=!0;break}}else if(d>=b&&w>=d){u.push(h),v=!0;break}}if(!v)if(1===m.length)u.push(m[0][0]);else{var x=void 0;if("gender"==l?(x=f["default"].find(m,function(t){return"N"===t}),x&&u.push("N")):"smoking"===l?(x=f["default"].find(m,function(t){return"W"===t}),x&&u.push("W")):(x=f["default"].find(m,function(t,e){return"*"===t}),x&&u.push("*")),f["default"].isUndefined(x)&&r)throw console.log("*** utils.js toKey--> unable to set the key value for ",t,l,a),Error("utils.js toKey -->Unable to set key value "+t,l,a)}}}),u.join(":")}function s(t,e,a){var r=arguments.length<=3||void 0===arguments[3]?!0:arguments[3],n=e._keys,u=[];return n.forEach(function(n){var i=_(n,2),l=i[0],o=i[1],d=a[l],s="_key_"+l,m=e[s],v=!1;if(1===m.length&&(f["default"].isUndefined(d)||f["default"].isNull(d)))u.push(m[0][0]);else{for(var c=0;c<m.length;c++){var g=m[c],p=_(g,2),h=p[0],y=p[1],b=h,w=y;if("int"===o?(b=parseInt(b),w="*"===w?w:parseInt(w),d=parseInt(d)):"number"===o?(b=parseFloat(b),w="*"===w?w:parseFloat(w),d=parseFloat(d)):"str"===o&&"string"!=typeof d&&(d=""+d),"*"===w){if(d===b){u.push(h),v=!0;break}}else if(d>=b&&w>=d){u.push(h),v=!0;break}}if(!v)if(1===m.length)u.push(m[0][0]);else{var x=void 0;if("gender"==l?(x=f["default"].find(m,function(t){return"N"===t}),x&&u.push("N")):"smoking"===l?(x=f["default"].find(m,function(t){return"W"===t}),x&&u.push("W")):(x=f["default"].find(m,function(t,e){return"*"===t}),x&&u.push("*")),f["default"].isUndefined(x)&&r)throw console.log("*** utils.js toKey--> unable to set the key value for ",t,l,a),Error("utils.js toKey -->Unable to set key value "+t,l)}}}),u.join(":")}var _=function(){function t(t,e){var a=[],r=!0,n=!1,u=void 0;try{for(var i,l=t[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!e||a.length!==e);r=!0);}catch(o){n=!0,u=o}finally{try{!r&&l["return"]&&l["return"]()}finally{if(n)throw u}}return a}return function(e,a){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();Object.defineProperty(e,"__esModule",{value:!0}),e.now=n,e.calcAge=u,e.toDate=i,e.toRow=l,e.roundTo=o,e.toKey=d,e.buildKeys=s;var m=a(1),f=r(m),v=a(2),c=r(v)},function(t,e,a){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e["default"]=t,e}function n(t){return t&&t.__esModule?t:{"default":t}}function u(t){var e=arguments.length<=1||void 0===arguments[1]?"ALAB":arguments[1];return Y.calcAge(e,t)}function i(){var t=new T.Context({}),e=new T.Entity(t,"product",0,{});t.set("product",e);var a=new T.Field(t,"get_main_plans",{parentType:"policy",parent:null}),r=a.getValue({product_id:0}),n=F["default"].keys(T.CONFIGS).map(function(t){return parseInt(t)}),u=F["default"].filter(r,function(t){return F["default"].includes(n,t.product_id)});return u}function l(t){var e=new T.Context({}),a=new T.Entity(e,"product",0,{});e.set("product",a);var r=new T.Field(e,"funds",{parentType:"product",parent:a}),n=r.getValue({product_id:0}),u={};F["default"].forEach(n,function(t){return u[t.fund_code]=t.fund_name});var i=new T.Entity(e,"product",F["default"].parseInt(t),{}),l=new T.Field(e,"product_funds",{parentType:"product",parent:i}),o=l.getValue({product_id:t}),d=[],s=void 0;return F["default"].forEach(o,function(t){s={},s.fund_code=t.fund_code,s.fund_name=u[s.fund_code],d.push(s)}),console.log(" availableFunds",d),d}function o(t){if(!F["default"].has(T.CONFIGS,t))return[];var e=new T.Context({}),a=new T.Entity(e,"product",t,{});e.set("product",a);var r=new T.Field(e,"payment_freqs",{parentType:"product",parent:a}),n=r.getValue("*",{product_id:t}),u={1:"Yearly",2:"Half-yearly",3:"Quarterly",4:"Monthly",5:"Single Premium"},i=F["default"].sortBy(n);return F["default"].zip(i,F["default"].map(i,function(t){return u[t]}))}function d(t){return F["default"].has(T.CONFIGS,t)?T.CONFIGS[t]:{}}function s(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if(!F["default"].has(T.CONFIGS,t))return[];var a=new T.Context({}),r=new T.Entity(a,"product",t,{});a.set("product",r);var n=new T.Field(a,"premium_terms",{parentType:"product",parent:r}),u=n.getValue("*",{product_id:t}),i=[],l=[];return F["default"].forEach(u,function(t){"3"===t.period?l.push(t.year):i.push(t.year)}),l.length>0&&(F["default"].isNull(e)||!function(){var t=void 0;F["default"].forEach(l,function(a){t=Y.toDate(e).add(a,"year").diff(Y.now(),"year"),i.push(t)})}()),i}function _(t){if("policy"in t){var e=t.policy;if("products"in e&&"people"in e){var a=e.products;if(a.length>0){var r=function(){var t=(e.people,a[0]),r=t.product_id,n=[];F["default"].forEach(a.slice(1),function(t){n.push(t.product_id)});var u=new T.Context({}),i=new T.Entity(u,"product",r,{});u.set("product",i);var l=new T.Field(u,"attachable_riders",{parentType:"product",parent:i}),o=l.getValue("*",{product_id:r}),d=new T.Entity(u,"product",0,{}),s=new T.Field(u,"mutually_exclusive_riders",{parentType:"product",parent:d}),_=new T.Field(u,"dependent_riders",{parentType:"product",parent:d}),m=F["default"].filter(o,function(t){var e=void 0,a=void 0,r=void 0;if(r=t.attach_id,s.reset(),_.reset(),e=s.getValue("*",{rider_id:r}),a=_.getValue("*",{rider_id:r}),"1"==t.attach_type&&F["default"].includes(n,r))return!1;var u=!1;return F["default"].forEach(e,function(t){var e=w(t,2),a=e[0],i=e[1];a===r&&F["default"].includes(n,i)&&(u=!0),i===r&&F["default"].includes(n,a)&&(u=!0)}),u?!1:(F["default"].forEach(a,function(t){var e=w(t,2),a=e[0],i=e[1];r!==a||F["default"].includes(n,i)||(u=!0)}),u?!1:!0)}),f=new T.Field(u,"get_riders",{parentType:"product",parent:d}),v=f.getValue("*",{}),c=F["default"].map(v,function(t){return t.product_id}),g=void 0;F["default"].forEach(m,function(t){g=c.indexOf(t.attach_id),g>=0&&(t.rider_name=v[g].product_name,t.rider_code=v[g].internal_id,t.rider_id=t.attach_id)});var p=F["default"].keys(T.CONFIGS).map(function(t){return parseInt(t)});return{v:F["default"].filter(m,function(t){return F["default"].includes(p,t.rider_id)})}}();if("object"===("undefined"==typeof r?"undefined":b(r)))return r.v}}}return[]}function m(t,e){if(t.policy.people&&0===t.policy.people.length)return["There are no people specified in the input json "];if(!(t.policy.products&&t.policy.products.length>0))return["There are no products specified in the input json "];var a=t.policy.products[0].product_id;if(!F["default"].has(T.CONFIGS,a))return["The product requested is not configured in the system"];var r={},n=new T.Context({});y(n,t);var u={main:0,fund:10,loading:20,pdt:30,r:31,pol:40,topup:50,withdraw:60},i=Object.keys(u),l=void 0,o=void 0,d=void 0,s=F["default"].sortBy(e,function(t){return l=t.split("."),o=1===l.length?"main":l[0],d=F["default"].find(i,function(t,e){return F["default"].startsWith(o,t)}),u[d]});return F["default"].forEach(s,function(t,e){var a=p(n,t);F["default"].isArray(a)||(a=[a]),a=F["default"].flattenDeep(a),a=F["default"].filter(a,function(t){return t&&t.length>0}),console.log("** Errors for validator  ",t,a),r[t]=a}),r}function f(t){if(t.policy.people&&0===t.policy.people.length)return["There are no people specified in the input json "];if(!(t.policy.products&&t.policy.products.length>0))return["There are no products specified in the input json "];var e=t.policy.products[0].product_id;if(!F["default"].has(T.CONFIGS,e))return["The product requested is not configured in the system"];var a=[],r=new T.Context({});y(r,t);d(r.get("main").product_id);return a}function v(t){var e=arguments.length<=1||void 0===arguments[1]?1:arguments[1];if(t.policy.people&&0===t.policy.people.length)return["There are no people specified in the input json "];if(!(t.policy.products&&t.policy.products.length>0))return["There are no products specified in the input json "];var a=t.policy.products[0].product_id;if(!F["default"].has(T.CONFIGS,a))return["There main plan requested is not configured in the system"];if(t.policy.products&&t.policy.products.length<2)return["There should be at least one rider specified in the input json for validation"];var r=[],n=new T.Context({});y(n,t);var u=n.get("main"),i=n.get("products")[e],l=i.val("initial_sa"),o=u.val("initial_sa"),d=i.val("sa_limit"),s=u.val("main_rider_sa_limit","*",{rider_id:i.val("product_id")}),_=l/o;l<d.insd_min_amount?r.push("The sum assured is less than the minimum required for the rider"):l>d.insd_max_amount&&r.push("The sum assured is more than the maximum allowed for the rider"),o<s.min_mast_sa_amt&&r.push("The main plan sum assured is less that the required minimum when atatching this rider"),l>s.max_ath_sa_amt&&r.push("The sum assured is more the maximum allowed when attached to the main plan"),_<s.min_ath_sa_rate&&r.push("The sum assured rate is less than the minimum required when attached to the main plan"),_>s.max_ath_sa_rate&&r.push("The sum assured rate is more than the maximum allowed when attached to the main plan");var m=i.val("age_limit"),f=u.val("main_rider_age_limit","*",{rider_id:i.val("product_id")}),v=u.val("entry_age"),c=i.val("entry_age");return"1"===m.min_insd_nb_age_unit&&(c<m.min_insd_nb_age?r.push("The age of the insured for the rider is less than the minimum allowed"):c>m.max_insd_nb_age&&r.push("The age of the insured for the rider is more than the maximum allowed")),c<f.min_ath_age&&r.push("The age of the insured for the rider is less than the minimum allowed when attached to the main plan"),c>f.max_ath_age&&r.push("The age of the insured for the rider is more than the maximum allowed when attached to the main plan"),v<f.min_ath_mast_age&&r.push("The age of the insured for the main is less than the minimum allowed when the rider is attached"),v>f.max_ath_mast_age&&r.push("The age of the insured for the main is more than the maximum allowed when the rider is attached"),r}function c(t){var e=arguments.length<=1||void 0===arguments[1]?[]:arguments[1],a=arguments.length<=2||void 0===arguments[2]?[]:arguments[2];if(console.log("calc function",e),t.policy.people&&0===t.policy.people.length)return t;if(!(t.policy.products&&t.policy.products.length>0))return t;var r=t.policy.products[0].product_id;if(!F["default"].has(T.CONFIGS,r))return t;var n=new T.Context({}),u=F["default"].clone(t,!0);y(n,t);var i=n.get("main"),l=i.val("max_t");n.set("current_t","*");var o=F["default"].sortBy(e,function(t){return 0===t.indexOf("fund.")?0:0===t.indexOf("pol.")?2:1});return F["default"].forEach(o,function(t,e){var a=h(n,t);console.log("** Value for svField item ",t,a)}),o=F["default"].sortBy(a,function(t){return 0===t.indexOf("fund.")?0:0===t.indexOf("pol.")?2:1}),F["default"].forEach(o,function(t,e){F["default"].forEach(F["default"].range(1,l+1),function(e){n.set("current_t",e);var a=h(n,t,e);e===l&&console.log("** Value for item for t ",t,e,a)})}),g(u,n),n=null,u}function g(t,e){var a=void 0,r=t.policy,n=(r.people,r.products),u=n.length>0?n[0].funds||[]:[];F["default"].forOwn(e.get("policy").getFields(),function(t,e){if(t instanceof T.Field&&t.fmlaField)if(a=F["default"].isNull(t.format1)?N.round_cents_half_up:N[t.format1],Object.keys(t.values).length>1)r[e]={},F["default"].forOwn(t.values,function(n,u){t.resolved[u]&&(r[e][u]=F["default"].isNull(a)?n:F["default"].isNumber(n)?a(n):n)});else if("*"in t.values&&t.resolved["*"]){var n=t.values["*"];r[e]=F["default"].isNull(a)?n:F["default"].isNumber(n)?a(n):n}});var i=void 0,l=void 0;return F["default"].forEach(e.get("products"),function(t,e){i=n[e],F["default"].forOwn(t.getFields(),function(t,e){if(t instanceof T.Field&&t.fmlaField)if(a=F["default"].isNull(t.format1)?N.round_cents_half_up:N[t.format1],Object.keys(t.values).length>1)i[e]={},F["default"].forOwn(t.values,function(r,n){t.resolved[n]&&(i[e][n]=F["default"].isNull(a)?r:F["default"].isNumber(r)?a(r):r)});else if("*"in t.values&&t.resolved["*"]){var r=t.values["*"];i[e]=F["default"].isNull(a)?r:F["default"].isNumber(r)?a(r):r}}),0===e&&F["default"].forEach(t.val("funds"),function(t,e){l=u[e],F["default"].forOwn(t.getFields(),function(t,e){if(t instanceof T.Field&&t.fmlaFieldField)if(a=F["default"].isNull(t.format1)?N.round_cents_half_up:N[t.format1],Object.keys(t.values).length>1)l[k]={},F["default"].forOwn(t.values,function(e,r){t.resolved[r]&&(l[k][r]=F["default"].isNull(a)?e:F["default"].isNumber(e)?a(e):e)});else if("*"in t.values&&t.resolved["*"]){var r=t.values["*"];l[k]=F["default"].isNull(a)?r:F["default"].isNumber(r)?a(r):r}})})}),t}function p(t,e){var a=(arguments.length<=2||void 0===arguments[2]?"*":arguments[2],e.split("."));if(1===a.length&&(a=["main",e]),"pdt_"===a[0].substr(0,4).toLowerCase()||"main"===a[0].toLowerCase()){var r=a[1],n=void 0;return"main"===a[0].toLowerCase()?n=t.get("main"):!function(){var e=a[0].substr(4),r=t.get("products"),u=F["default"].filter(r,function(t){return t.val("internal_id")===e});n=u.length>0?u[0]:null}(),t.set("product",n),t.set("product_id",n.val("product_id")),n.validate(r)}if(/^r\d$/.test(a[0])){var u=parseInt(a[0].split(".")[0].substr(1)),n=t.get("products")[u];return t.set("product",n),t.set("product_id",n.val("product_id")),n.validate(a[1])}if("pol"===a[0].substr(0,3)){var i=a[1],l=t.get("policy"),o=t.get("main");return t.set("product",o),t.set("product_id",o.val("product_id")),l.validate(i)}if("fund"===a[0].toLowerCase().substr(0,4)){var d=function(){var e=a[0].substr(4).toLowerCase(),r=t.get("funds"),n=F["default"].filter(r,function(t){return t.val("fund_code")===e}),u=n.length>0?n[0]:null,i=a[1];return t.set("fund",u),t.set("product",t.get("main")),t.set("product_id",t.get("main").val("product_id")),{v:u.validate(i)}}();if("object"===("undefined"==typeof d?"undefined":b(d)))return d.v}else if("topup"===a[0].toLowerCase().substr(0,5)){var s=function(){var e=t.get("policy"),r=e.val("topups"),n=parseInt(a[1]),u=F["default"].filter(r,function(t){return t.val("year")===n});if(u.length>0){var i=u[0];return{v:i.validate(validatorName)}}throw Error("Unable to locate topup validator "+validatorName)}();if("object"===("undefined"==typeof s?"undefined":b(s)))return s.v}else if("withdraw"===a[0].toLowerCase().substr(0,5)){var _=function(){var e=t.get("policy"),r=e.val("withdrawals"),n=parseInt(a[1]),u=F["default"].filter(r,function(t){return t.val("year")===n});if(u.length>0){var i=u[0];return{v:i.validate(validatorName)}}throw Error("Unable to locate withdrawal validator "+validatorName)}();if("object"===("undefined"==typeof _?"undefined":b(_)))return _.v}}function h(t,e){var a=arguments.length<=2||void 0===arguments[2]?"*":arguments[2],r=e.split(".");if(1===r.length&&(r=["main",e]),"pdt_"===r[0].substr(0,4).toLowerCase()||"main"===r[0].toLowerCase()){var n=r[1],u=void 0;return"main"===r[0].toLowerCase()?u=t.get("main"):!function(){var e=r[0].substr(4),a=t.get("products"),n=F["default"].filter(a,function(t){return t.val("internal_id")===e});u=n.length>0?n[0]:null}(),t.set("product",u),t.set("product_id",u.val("product_id")),u.val(n,a)}if(/^r\d$/.test(r[0])){var i=parseInt(r[0].split(".")[0].substr(1)),u=t.get("products")[i];return t.set("product",u),t.set("product_id",u.val("product_id")),u.val(r[1],a)}if("pol"===r[0].substr(0,3)){var n=r[1],l=t.get("policy"),o=t.get("main");return t.set("product",o),t.set("product_id",o.val("product_id")),l.val(n,a)}if("fund"===r[0].toLowerCase().substr(0,4)){var d=function(){var e=r[0].substr(4).toLowerCase(),n=t.get("funds"),u=F["default"].filter(n,function(t){return t.val("fund_code")===e}),i=u.length>0?u[0]:null,l=r[1];return t.set("fund",i),t.set("product",t.get("main")),t.set("product_id",t.get("main").val("product_id")),{v:i.val(l,a)}}();if("object"===("undefined"==typeof d?"undefined":b(d)))return d.v}}function y(t,e){var a=F["default"].clone(e,!0),r=a.policy||{},n=r.people||[],u=r.products||[],i=(r.topups||[],r.withdrawals||[],void 0),l=void 0,o=void 0;i=[],o=[],u.length>0&&(l=u[0]),l&&(i=l.funds||[]);var d=l.product_id,s=new T.Entity(t,"policy",d,{});t.set("policy",s),F["default"].forOwn(r,function(e,a){if("people"!==a&&"products"!==a&&"topups"!==a&&"withdrawals"!==a){var r=new T.Field(t,a,{parentType:"policy",parent:s,inputField:!0,value:e});s.setField(a,r)}else("topups"===a||"withdrawals"===a)&&!function(){var r=void 0,n=void 0,u=[],i="topups"===a?"topup":"withdrawal";F["default"].forEach(e,function(e,l){r=new T.Entity(t,i,d,{}),F["default"].forOwn(e,function(e,u){n=new T.Field(t,a,{parentType:i,parent:r,inputField:!0,value:e}),r.setField(u,n)}),u.push(r)}),s.setField(a,u)}()});var _=s.getFields();"topups"in _||s.setField("topups",[]),"withdrawals"in _||s.setField("withdrawals",[]);var m=[];F["default"].forEach(i,function(e,a){var r=new T.Entity(t,"fund",d,{});F["default"].forOwn(e,function(e,a){var n=new T.Field(t,a,{parentType:"fund",parent:r,inputField:!0,value:e});r.setField(a,n)}),m.push(r)}),t.set("funds",m);var f=[];F["default"].forEach(u,function(e,a){var r=e.product_id,n=new T.Entity(t,"product",r,{}),u=!1;F["default"].forOwn(e,function(e,i){if(0===a&&"funds"===i)n.setField("funds",m);else if("loadings"===i)!function(){u=!0;var a=void 0,l=void 0,o=[];F["default"].forEach(e,function(e,n){a=new T.Entity(t,"loading",r,{}),F["default"].forOwn(e,function(e,r){l=new T.Field(t,r,{parentType:"loading",parent:a,inputField:!0,value:e}),a.setField(r,l)}),o.push(a)}),n.setField(i,o)}();else{var l=new T.Field(t,i,{parentType:"product",parent:n,inputField:!0,value:e});n.setField(i,l)}}),u||n.setField("loadings",[]),f.push(n),0===a&&t.set("main",n),s.setField("products",f),t.set("products",f)});var v=[];return F["default"].forEach(n,function(e,a){var r=new T.Entity(t,"people",d,{});F["default"].forOwn(e,function(e,a){var n=new T.Field(t,a,{parentType:"people",parent:r,inputField:!0,value:e});r.setField(a,n)}),v.push(r)}),s.setField("people",v),t.set("people",v),a=null,t}var b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},w=function(){function t(t,e){var a=[],r=!0,n=!1,u=void 0;try{for(var i,l=t[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!e||a.length!==e);r=!0);}catch(o){n=!0,u=o}finally{try{!r&&l["return"]&&l["return"]()}finally{if(n)throw u}}return a}return function(e,a){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();Object.defineProperty(e,"__esModule",{value:!0}),e.availableFunds=e.validate=e.validateRider=e.validateMain=e.getSIConfig=e.availableRiders=e.getPremiumTerms=e.getPaymentFrequencies=e.availablePlans=e.calcAge=e.calc=void 0;var x=a(1),F=n(x),M=a(2),O=(n(M),a(3)),Y=r(O),j=a(13),T=r(j),E=a(14),N=r(E);e.calc=c,e.calcAge=u,e.availablePlans=i,e.getPaymentFrequencies=o,e.getPremiumTerms=s,e.availableRiders=_,e.getSIConfig=d,e.validateMain=f,e.validateRider=v,e.validate=m,e.availableFunds=l},function(t,e,a){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e["default"]=t,e}function n(t){return t&&t.__esModule?t:{"default":t}}function u(t,e,a,r,n,u,i){return 0}function i(t,e,a,r,n,u,i){var l=e.val("proposal_date");return(0,N["default"])(l,["D-M-YYYY","YYYY-M-D"]).subtract(1,"month").endOf("month").add(1,"day").format("YYYY-MM-DD")}function l(t,e,a,r,n,u,i){var l=r.val("product_life").age_method;return"1"===l?"ANB":"2"===l?"ALAB":"3"===l?"ANMB":"4"===l?"ANRB":"ANRBM"}function o(t,e,a,r,n,u,i){var l=t.get("main"),o=l.val("age_limit"),d=o.max_insd_nb_age_unit,s=o.max_insd_nb_age,_="1"===d&&s+5>40?s+5:40,m=l.val("age_method"),f=a[l.val("la")],v=f.val("dob"),c=P.calcAge(m,v),g=_-5*Math.ceil(c/5);return g}function d(t,e,a,r,n,u,i){var l=r.val("premium_terms",u,{}),o=[];if(o=T["default"].filter(l,function(t){return"2"===t.period}),1===o.length)return 12*o[0].year;throw Error("common.js->max_t__02, incorrectly configured formula, there should only be 1 record in allowable prem terms")}function s(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i=(arguments[6],t.exists("product")?t.get("product"):t.get("main")),l=(i.val("la"),e.val("products")[0]),o=l.val("age_method"),d=a[l.val("la")],s=d.val("dob"),_=P.calcAge(o,s);return _+u-1}function _(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5];arguments[6];return r.val("entry_age")+u-1}function m(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i=(arguments[6],r.val("age_method")),l=a[r.val("la")],o=P.toDate(e.val("proposal_start_date")),d=l.val("dob");o.add(u,"months");var s=N["default"].isMoment(d)?d:P.toDate(d);T["default"].has(s,"isValid")||(s=(0,N["default"])(s));var _=s.month()===o.month()&&s.day()===o.day()?!0:!1,m=o.diff(s,"years");return"ANB"===i?m=_?m:m+1:"ALAB"===i?m=_?m-1:m:(age1=o.diff(s,"years",!0),m=age1-m>.5?m:m+1),m}function f(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5];arguments[6];if(0===u)return 0;var i=r.val("tdc_rate_a",tt).rate_value,l=r.val("tdc_rate_b",tt).rate_value,o=r.val("tdc_rate_c",tt).rate_value;return r.val("tdc",u-1)+r.val("apt",u)*i*l*o}function v(t,e,a,r,n){var u=(arguments.length<=5||void 0===arguments[5]?0:arguments[5],arguments[6],e.val("products")[0]),i=u.val("age_limit").max_insd_nb_ex_age,l=r.val("entry_age");return i-l}function c(t,e,a,r,n){arguments.length<=5||void 0===arguments[5]?0:arguments[5],arguments[6];return 60-r.val("entry_age")}function g(t,e,a,r,n){arguments.length<=5||void 0===arguments[5]?0:arguments[5],arguments[6];return 65-r.val("entry_age")}function p(t,e,a,r,n){arguments.length<=5||void 0===arguments[5]?0:arguments[5],arguments[6];return r.val("age_limit").max_insd_nb_ex_age-r.val("entry_age")}function h(t,e,a,r,n){var u=(arguments.length<=5||void 0===arguments[5]?0:arguments[5],arguments[6],e.val("products")[0]),i=u.val("age_limit").max_insd_nb_ex_age,l=r.val("entry_age");return i-l}function y(t,e,a,r,n){var u=(arguments.length<=5||void 0===arguments[5]?0:arguments[5],arguments[6],t.get("main")),i=r.dbval("age_limit").max_insd_nb_ex_age,l=r.val("entry_age"),o=u.dbval("age_limit").max_insd_nb_ex_age,d=u.val("entry_age"),s=Math.min(o-d,i-l);return console.log("coverage_duration_02, res",s),s}function b(t,e,a,r,n){arguments.length<=5||void 0===arguments[5]?0:arguments[5],arguments[6];return r.val("age_limit").max_insd_nb_ex_age}function w(t,e,a,r,n){arguments.length<=5||void 0===arguments[5]?0:arguments[5],arguments[6];return r.val("entry_age")+r.val("cover_term")}function x(t,e,a,r,n){arguments.length<=5||void 0===arguments[5]?0:arguments[5],arguments[6];return r.val("coverage_term")}function F(t,e,a,r,n){var u=(arguments.length<=5||void 0===arguments[5]?0:arguments[5],arguments[6],r.val("age_method")),i=a[r.val("la")],l=i.val("dob");return P.calcAge(u,l)}function M(t,e,a,r,n){var u=(arguments.length<=5||void 0===arguments[5]?0:arguments[5],arguments[6],r.val("age_method")),i=T["default"].find(a,function(t){return t.input("is_ph")});if(i){var l=i.val("dob");return P.calcAge(u,l)}return 0}function O(t,e,a,r,n){arguments.length<=5||void 0===arguments[5]?0:arguments[5],arguments[6];return r.val("basic_sa")}function k(t,e,a,r,n){arguments.length<=5||void 0===arguments[5]?0:arguments[5],arguments[6];return r.val("initial_sa")}function Y(t,e,a,r,n){arguments.length<=5||void 0===arguments[5]?0:arguments[5],arguments[6];return 5e4*r.val("initial_sa")}Object.defineProperty(e,"__esModule",{value:!0}),e.zero=u,e.proposal_start_date__01=i,e.age_method__01=l,e.max_t__0327=o,e.max_t__01=d,e.age_at_t__01=s,e.age_at_t__02=_,e.age_at_t__03=m,e.tdc__01=f,e.cover_duration__01=v,e.cover_term__03=c,e.cover_term__04=g,e.cover_term__05=p,e.coverage_term__01=h,e.coverage_term__02=y,e.maturity_age__01=b,e.maturity_age__02=w,e.premium_term__01=x,e.entry_age__01=F,e.ph_entry_age__01=M,e.sa_calculated__01=O,e.sa_calculated__02=k,e.sa_calculated__03=Y;var j=a(1),T=n(j),E=a(2),N=n(E),C=a(3),P=r(C)},function(t,e,a){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e["default"]=t,e}function n(t){return t&&t.__esModule?t:{"default":t}}function u(t,e,a,r,n,u,i){var l=r.val("initial_sa")||0;return f.roundTo(l)}function i(t,e,a,r,n,u,i){var l=r.val("initial_sa")||0,o=r.val("sa_schedule",u).sa_rate||1,d=r.val("lien_rate",u).lien_rate||1;return l*o*d}function l(t,e,a,r,n,u,i){return r.val("dbgt")+r.val("dbng")}function o(t,e,a,r,n,u,i){return r.val("dbgt",u)+r.val("dbng",u)}function d(t,e,a,r,n,u,i){return r.val("dbt",u)+r.val("accsb",u)}Object.defineProperty(e,"__esModule",{value:!0}),e.dbg__01=u,e.dbgt__01=i,e.db__01=l,e.dbt__01=o,e.tot_dbt__01=d;var s=a(1),_=(n(s),a(2)),m=(n(_),a(3)),f=r(m)},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a(5),n=function(t){return"default"===t?"continue":void Object.defineProperty(e,t,{enumerable:!0,get:function(){return r[t]}})};for(var u in r){n(u)}var i=a(9),l=function(t){return"default"===t?"continue":void Object.defineProperty(e,t,{enumerable:!0,get:function(){return i[t]}})};for(var o in i){l(o)}var d=a(6),s=function(t){return"default"===t?"continue":void Object.defineProperty(e,t,{enumerable:!0,get:function(){return d[t]}})};for(var _ in d){s(_)}var m=a(11),f=function(t){return"default"===t?"continue":void Object.defineProperty(e,t,{enumerable:!0,get:function(){return m[t]}})};for(var v in m){f(v)}var c=a(10),g=function(t){return"default"===t?"continue":void Object.defineProperty(e,t,{enumerable:!0,get:function(){return c[t]}})};for(var p in c){g(p)}var h=a(8),y=function(t){return"default"===t?"continue":void Object.defineProperty(e,t,{enumerable:!0,get:function(){return h[t]}})};for(var b in h){y(b)}e.FIXME="FIXME"},function(t,e,a){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e["default"]=t,e}function n(t){return t&&t.__esModule?t:{"default":t}}function u(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i=arguments[6];return r.val("basic_cost_at_t",u,i)+r.val("total_loadings",u,i)}function i(t,e,a,r,n){arguments.length<=5||void 0===arguments[5]?0:arguments[5],arguments[6];return r.val("coi_at_t",1)/12}function l(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i=(arguments[6],a[r.val("la")],r.input("basic_sa")),l=r.dbval("unit_rate").sa_unit_amount,o=r.db0("lsad_rate")||0,d=r.db0("coi_rate",u);return i/l*(d-o)}function o(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i=(arguments[6],void 0);return K["default"].sum(K["default"].map(r.val("loadings"),function(t,e){return i=t.val("rate"),"percentage"===t.val("type")?r.val("basic_cost_at_t",u)*i/100:r.val("sa_calculated")*i/r.dbval("unit_rate").sa_unit_amount}))}function d(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i=(arguments[6],void 0);return i=K["default"].filter(e.val("withdrawals"),function(t,e){return t.val("year")===u}),i.length>0?i[0].val("amount"):0}function s(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i=(arguments[6],void 0);return i=K["default"].filter(e.val("withdrawals"),function(t,e){return t.val("year")===u}),i.length>0?i[0].val("amount"):0}function _(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i=(arguments[6],K["default"].filter(e.val("topups"),function(t,e){return t.val("year")===u})),l=1-r.val("atu_expense_fee",u).assign_rate;return i.length>0?i[0].val("amount")*l:0}function m(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i=(arguments[6],K["default"].filter(e.val("topups"),function(t,e){return t.val("year")===u}));return i.length>0?i[0].val("amount"):0}function f(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i=(arguments[6],1-r.val("tp_expense_fee",u).assign_rate);return u>r.val("premium_term")?0:r.input("target_premium")*r.dbval("modal_factor").charge_rate*i}function v(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5];arguments[6];return u>r.val("premium_term")?0:r.input("target_premium")*r.dbval("modal_factor").charge_rate}function c(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i=(arguments[6],r.val("premium_term")),l=1-r.val("rtu_expense_fee",u).assign_rate;return u>i?0:r.input("rtu")*r.val("modal_factor").charge_rate*l}function g(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i=(arguments[6],r.val("premium_term"));return u>i?0:r.input("rtu")*r.val("modal_factor").charge_rate}function p(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5];arguments[6];return r.val("ilp_pol_fee_rate",u).assign_rate}function h(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5];arguments[6];return K["default"].sum(K["default"].map(K["default"].range(1,u+1),function(t){return r.val("debt_for_t",t)}))}function y(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i=(arguments[6],1),l=r.val("debt_accum_period");return u>=i&&l>=u?r.val("pol_fee_at_t",u)+r.val("coi_at_t",u)+r.val("total_cor_at_t",u):0}function b(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5];arguments[6];return K["default"].sum(K["default"].map(K["default"].range(1,u+1),function(t){return r.val("debt_repay_for_t",t)}))}function w(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i=(arguments[6],t.get("main")),l=i.val("debt_accum_period")+1,o=i.val("debt_repay_period"),d=l+o-1;return u>=l&&d>=u?d>u?r.val("debt_at_t",u-1)/o:r.val("debt_at_t",u-1)-r.val("debt_paid_at_t",u-1):0}function x(t,e,a,r,n){arguments.length<=5||void 0===arguments[5]?0:arguments[5],
arguments[6];return 2}function F(t,e,a,r,n){arguments.length<=5||void 0===arguments[5]?0:arguments[5],arguments[6];return 2}function M(t,e,a,r,n,u,i){var l=e.val("prem_freq"),o=void 0;return o="1"===l?12:"2"===l?9:"3"===l?7.5:6.5}function O(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i=(arguments[6],0),l=0;return K["default"].forEach(K["default"].range(1,u+1),function(t,e){i+=r.val("debt_for_t",t),l+=r.val("debt_repay_for_t",t)}),i-l}function k(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i=arguments[6];return T(t,e,a,r,n,u,K["default"].extend(i,{rate_type:"fund_low_rate"}))}function Y(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i=arguments[6];return T(t,e,a,r,n,u,K["default"].extend(i,{rate_type:"fund_mid_rate"}))}function j(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i=arguments[6];return T(t,e,a,r,n,u,K["default"].extend(i,{rate_type:"fund_high_rate"}))}function T(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i=arguments[6];if(!1 in i)throw Error("Function tiv_at_t__01, please specify the rate_type");var l=i.rate_type,o="fund_low_rate"===l?"tiv_low_at_t":"fund_mid_rate"===l?"tiv_mid_at_t":"tiv_high_at_t";if(0===u)return 0;var d=0,s=(r.val("debt_accum_period"),r.val("debt_repay_period")),_=1,m=r.val("debt_accum_period"),f=m+1,v=f+s-1,c=r.val(l,u).rate,g=r.val("accum_factor"),p=u>=f&&v>=u?r.val("debt_repay_for_t",u):0,h=u>=_&&m>=u?0:(r.val("coi_at_t",u)+r.val("total_cor_at_t",u)+r.val("mac_at_t",u)+r.val("pol_fee_at_t",u)+p)*Math.pow(1+c,6.5/12);return d+=(e.val("atu_at_t",u)+r.val(o,u-1))*(1+c),d+=(r.val("rtu_at_t",u)+r.val("tp_at_t",u))*Math.pow(1+c,g/12),d-=h,d-=e.val("withdrawal_at_t",u)}function E(t,e,a,r,n,u,i){var l=r.val("basic_sa")||0,o=r.val("lien_rate",u).lien_rate||1;return H.roundTo(l*o)}function N(t,e,a,r,n,u,i){return r.val("tiv_low_at_t",u,i)+r.val("dbg_at_t",u,i)}function C(t,e,a,r,n,u,i){return r.val("tiv_mid_at_t",u,i)+r.val("dbg_at_t",u,i)}function P(t,e,a,r,n,u,i){return r.val("tiv_high_at_t",u,i)+r.val("dbg_at_t",u,i)}function I(t,e,a,r,n){arguments.length<=5||void 0===arguments[5]?1:arguments[5],arguments[6];return r.val("cor_at_t",1)/12}function A(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i=arguments[6],l=r.db0("premium_rateaccident",u,i),o=r.input("initial_sa"),d=r.val("total_loadings","*",i);return u<=r.val("cover_term")?o*l/1e3+d:0}function D(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i=arguments[6];if(r.val("age_at_t",u)>r.val("coverage_age"))return 0;var l=r.db0("premium_ratereimbursement",u,i),o=r.db0("inflation_rate",u,i),d=r.val("total_loadings","*",i);return l*o+d}function R(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i=arguments[6];if(u>r.val("cover_term",u))return 0;var l=r.db0("premium_ratecash_benefit",u,i),o=r.input("initial_sa",u,i),d=r.fmval("total_loadings",1,i);return l*o+d}function q(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5];arguments[6];return K["default"].sum(K["default"].map(e.val("products"),function(t,e){return 0===e?0:t.val("cor_at_t",u,{})}))}function L(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5];arguments[6];return 0===u?0:e.val("accum_cor_at_t",u-1)+e.val("total_cor_at_t",u)}Object.defineProperty(e,"__esModule",{value:!0}),e.coi_at_t__01=u,e.monthly_coi__01=i,e.basic_cost_at_t__01=l,e.total_loadings__01=o,e.withdrawal_at_t__01=d,e.out_at_t__01=s,e.atu_at_t__01=_,e.in_at_t__01=m,e.tp_at_t__01=f,e.target_premium_at_t__01=v,e.rtu_at_t__01=c,e.regular_topup_at_t__01=g,e.pol_fee_at_t__01=p,e.debt_at_t__01=h,e.debt_for_t__01=y,e.debt_paid_at_t__01=b,e.debt_repay_for_t__01=w,e.debt_accum_period__02=x,e.debt_repay_period__02=F,e.accum_factor__01=M,e.outstd_debt_at_t__01=O,e.tiv_low_at_t__01=k,e.tiv_mid_at_t__01=Y,e.tiv_high_at_t__01=j,e.dbg_at_t__10=E,e.db_low_at_t__10=N,e.db_mid_at_t__10=C,e.db_high_at_t__10=P,e.monthly_cor__01=I,e.cor_at_t__01=A,e.cor_at_t__02=D,e.cor_at_t__03=R,e.total_cor_at_t__01=q,e.accum_cor_at_t__01=L;var S=a(1),K=n(S),V=a(2),U=(n(V),a(3)),H=r(U)},function(t,e,a){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e["default"]=t,e}function n(t){return t&&t.__esModule?t:{"default":t}}function u(t,e,a,r,n,u,i){var l=a[r.val("la")],o=r.val("initial_sa"),d=r.val("sa_unit_rate").unit_amount,s=r.val("lsad_rate").discount_rate||0,_=r.val("premium_rate").premium_rate,m=l.val("is_foreigner"),f=m?1.5:1,v=void 0;return v=o/d*f*(_-s),w.roundTo(v,2)}function i(t,e,a,r,n,u,i){var l=(a[r.val("la")],r.val("initial_sa")),o=r.val("unit_rate").sa_unit_amount,d=r.val("lsad_rate").discount_rate||0,s=r.val("premium_rate").pr_1;return l/o*(s-d)}function l(t,e,a,r,n,u,i){var l=(a[r.val("la")],r.val("initial_sa")),o=r.val("unit_rate").sa_unit_amount,d=r.val("lsad_rate").discount_rate||0,s=r.val("premium_rate").result_value_1;return l/o*(s-d)}function o(t,e,a,r,n,u,i){var l=a[r.val("la")],o=r.val("initial_sa"),d=r.val("sa_unit_rate").unit_amount,s=r.val("lsad_rate").discount_rate||0,_=l.val("dob"),m=r.val("age_method"),f=Math.floor((u+4)/5),v={age:w.calcAge(m,_)+(5*f-5)},c=r.val("premium_rate",u,v).premium_rate,g=l.val("is_foreigner"),p=g?1.5:1;return w.roundTo(o/d*p*(c-s),0)}function d(t,e,a,r,n,u,i){return u>r.val("premium_term")?0:r.val("ap")}function s(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5];arguments[6];return 0===u?0:r.val("apt",u)+r.val("tpp",u-1)}function _(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5];arguments[6];return 0===u?0:r.val("premium_at_t",u)+r.val("tpp",u-1)}function m(t,e,a,r,n,u,i){var l=r.val("modal_factor").charge_rate;return r.val("ap")*l}function f(t,e,a,r,n,u,i){var l=e.input("prem_freq"),o=0;return o="4"===l?r.val("ap")*r.val("modal_factor").charge_rate:u%12===1?r.val("ap"):0}function v(t,e,a,r,n,u,i){return h["default"].sum(h["default"].map(e.val("products"),function(t,e){return t.val("ap")}))}function c(t,e,a,r,n,u,i){var l=u?u:0;return 0===l?0:h["default"].sum(h["default"].map(e.val("products"),function(t){return t.val("apt",l)}))}function g(t,e,a,r,n,u,i){var l=u?u:0;return 0===l?0:e.val("pol_tpp",l-1)+e.val("pol_apt",l)}Object.defineProperty(e,"__esModule",{value:!0}),e.ap__01=u,e.ap__02=i,e.ap__03=l,e.apt__01=o,e.apt__02=d,e.tpp__01=s,e.tpp__02=_,e.prem__01=m,e.premium_at_t__01=f,e.totprem__01=v,e.pol_apt__01=c,e.pol_tpp__01=g;var p=a(1),h=n(p),y=a(2),b=(n(y),a(3)),w=r(b)},function(t,e,a){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e["default"]=t,e}function n(t){return t&&t.__esModule?t:{"default":t}}function u(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5];arguments[6];if(0===u)return 0;var i=r.val("cash_value",u),l=u===r.val("coverage")?i.sv_sb:i.sv,o=r.val("unit_rate",u).sa_unit_amount,d=r.val("initial_sa");return d*l/o}function i(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5];arguments[6];if(0===u)return 0;var i=0;return u>96&&108>=u?i=.5:u>108&&999>=u&&(i=.8),r.val("tpp",u)*i}function l(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5];arguments[6];return 0===u?0:r.val("svg",u)+r.val("accsb",u)}Object.defineProperty(e,"__esModule",{value:!0}),e.svg__01=u,e.svg_at_t__01=i,e.tsv__01=l;var o=a(1),d=(n(o),a(2)),s=(n(d),a(3));r(s)},function(t,e,a){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e["default"]=t,e}function n(t){return t&&t.__esModule?t:{"default":t}}function u(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5];arguments[6];if(u===r.val("coverage"))return 0;var i=r.val("sb_config",u).sur_amount||0,l=r.val("sb_pay",u).pay_amount||0,o=r.val("initial_sa");return o*(l/i)}function i(t,e,a,r,n){arguments.length<=5||void 0===arguments[5]?0:arguments[5],arguments[6];return.045}function l(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?0:arguments[5];arguments[6];if(0==u)return 0;var i=(r.val("accsbrate"),r.val("accsb",u-1)*(1+r.val("accsbrate"))+r.val("sbg",u));return i}Object.defineProperty(e,"__esModule",{value:!0}),e.sbg__01=u,e.accsbrate__01=i,e.accsb__01=l;var o=a(1),d=(n(o),a(2)),s=(n(d),a(3));r(s)},function(e,a,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e["default"]=t,e}function u(t){return t&&t.__esModule?t:{"default":t}}function i(t,e,a,r,n){arguments.length<=5||void 0===arguments[5]?"0":arguments[5],arguments.length<=6||void 0===arguments[6]?{}:arguments[6];return{}}function l(t,e,a,r,n,u,i,l){var o=arguments.length<=8||void 0===arguments[8]?!0:arguments[8],d=it["default"].has(i,"product_id")?i.product_id:r.val("product_id"),s=r.val("product_data",u,{pid:d});if(l in s){var _=s[l],m=st.toKey(l,_._meta,i,o);if(m in _){var f=st.toRow(_._meta._cols,_[m]);return f}}return{}}function o(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"0":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],o="product_life",d={product_id:r.val("product_id")};return d=it["default"].extend(d,i),l(t,e,a,r,n,u,d,o)}function d(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=it["default"].has(i,"product_id")?i.product_id:r.val("product_id"),o=r.val("product_data",u,{pid:l});if(!("unit_amount"in o))return{};var d=o.unit_amount,s=st.toKey("unit_amount",d._meta,i);if(s in d){var _=st.toRow(d._meta._cols,d[s]);return _}}function s(e,a,r,n,u){var i=arguments.length<=5||void 0===arguments[5]?"0":arguments[5],l=arguments.length<=6||void 0===arguments[6]?{}:arguments[6];if(0===i)return 0;var o=it["default"].has(opts,"product_id")?opts.product_id:n.val("product_id"),d=n.val("product_data",t,{pid:o});if("tdc_pos"in d){var s=it["default"].clone(l,!0),_=d.tdc_pos,m=st.toKey("tdc_pos",_._meta,s);if(m in _){var f=st.toRow(_._meta._cols,_[m]);return f}}return{}}function _(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6];return i.tdc_table="A",s(t,e,a,r,n,u,i)}function m(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6];return i.tdc_table="B",s(t,e,a,r,n,u,i)}function f(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6];return i.tdc_table="C",s(t,e,a,r,n,u,i)}function v(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=it["default"].has(i,"product_id")?i.product_id:r.val("product_id"),o=r.val("product_data",u,{pid:l}),d="large_sa_discount_rate";if(d in o){var s=it["default"].clone(i);"sa_amount"in s||(s.sa_amount=r.val("initial_sa"));var _=o[d],m=st.toKey(d,_._meta,s);if(m in _){var f=st.toRow(_._meta._cols,_[m]);return f}}return{}}function c(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=(arguments[6],a[r.val("la")]),l=r.val("age_method"),o=i.val("dob"),d=i.val("gender").toLowerCase(),s=i.val("smoker"),_=i.val("job_class"),m=r.val("coverage_term",u),f=r.val("benefit_level",u),v=r.val("initial_sa"),c=r.val("sa_unit_rate"),g=i.val("insured_status"),p=r.val("loan_rate",u),h=r.val("premium_term",u);return{age:st.calcAge(l,o),gender:"male"===d?"M":"female"===d?"F":"W",smoking:null===s?"W":s?"Y":"N",job_class:_,period:m?12*parseInt(m):null,benefit_level:f?f:null,amount:v?v:null,units:c,insured_status:g?g:null,loan_rate:p?p:"0.0",premium_year:h?h:null}}function g(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=it["default"].has(i,"product_id")?i.product_id:r.val("product_id"),o=r.val("product_data",u,{pid:l}),d="premium_rate";if(d in o){var s=c(t,e,a,r,n,u="*",i);s=it["default"].extend(s,i);var _=o[d],m=st.toKey(d,_._meta,s);if(m in _){var f=st.toRow(_._meta._cols,_[m]);return f}}return{}}function p(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=it["default"].has(i,"product_id")?i.product_id:r.val("product_id"),o=r.val("product_data",u,{pid:l}),d="age_limit";if(d in o){var s={};s.charge_period=r.val("charge_period"),s.charge_year=r.val("charge_year"),s.coverage_period=r.val("coverage_period"),s.coverage_year=r.val("coverage_year"),s.pay_period=r.val("pay_period"),s.pay_year=r.val("pay_year"),s.end_period=r.val("end_period"),s.end_year=r.val("end_year"),s.charge_type=e.val("prem_freq"),s.sa=r.val("initial_sa"),s=it["default"].extend(s,i);var _=o[d],m=st.toKey(d,_._meta,s);if(m in _)return st.toRow(_._meta._cols,_[m])}return{}}function h(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6];if(!i.rider_id&&!i.attach_id)return{};var l=it["default"].has(i,"product_id")?i.product_id:r.val("product_id"),o=r.val("product_data",u,{pid:l}),d="main_rider_age_limit";if(d in o){var s={};s.attach_id=i.rider_id,s=it["default"].extend(s,i);var _=o[d],m=st.toKey(d,_._meta,s);if(m in _)return st.toRow(_._meta._cols,_[m])}return{}}function y(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6];if(!i.rider_id&&!i.attach_id)return{};var l=it["default"].has(i,"product_id")?i.product_id:r.val("product_id"),o=r.val("product_data",u,{pid:l}),d="main_rider_sa_limit";if(d in o){var s={},_=a[r.val("la")],m=_.val("gender").toLowerCase();s.attach_id=i.rider_id,s.age=r.val("entry_age"),s.gender="male"===m?"M":"female"===m?"F":"W",s.job="*",s=it["default"].extend(s,i);var f=o[d],v=st.toKey(d,f._meta,s);if(v in f)return st.toRow(f._meta._cols,f[v])}return{}}function b(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6];if(!i.rider_id&&!i.attach_id)return{};var l=it["default"].has(i,"product_id")?i.product_id:r.val("product_id"),o=r.val("product_data",u,{pid:l}),d="rider_rider_sa_limit";if(d in o){var s={},_=a[r.val("la")],m=_.val("gender").toLowerCase();s.attach_id=i.rider_id,s.age=r.val("entry_age"),s.gender="male"===m?"M":"female"===m?"F":"W",s.job="*",s=it["default"].extend(s,i);var f=o[d],v=st.toKey(d,f._meta,s);if(v in f)return st.toRow(f._meta._cols,f[v])}return{}}function w(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=it["default"].has(i,"product_id")?i.product_id:r.val("product_id"),o=r.val("product_data",u,{pid:l}),d="sa_limit";if(d in o){var s={},_=a[r.val("la")];s.pay_mode=r.val("payment_method"),s.insured_status=_.val("insured_status"),s.age_month=12*r.val("entry_age"),s.job_cate=_.val("job_class"),s=it["default"].extend(s,i);var m=o[d],f=st.toKey(d,m._meta,s);if(f in m)return st.toRow(m._meta._cols,m[f])}return{}}function x(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=it["default"].has(i,"product_id")?i.product_id:r.val("product_id"),o=r.val("product_data",u,{pid:l}),d="prem_limit";if(d in o){var s={};a[r.val("la")];s.pay_mode=r.val("payment_method"),s.charge_type=e.val("prem_freq"),s=it["default"].extend(s,i);var _=o[d],m=st.toKey(d,_._meta,s);if(m in _)return st.toRow(_._meta._cols,_[m])}return{}}function F(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"0":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=it["default"].has(i,"product_id")?i.product_id:r.val("product_id"),o=r.val("product_data",u,{pid:l}),d="cash_value";if(d in o){var s={},_=a[r.val("la")],m=r.val("age_method"),f=_.val("dob");s.age=st.calcAge(m,f),s.age_month=12*s.age,s.benefit_level=r.val("benefit_level")||null,s.charge_type=e.val("prem_freq"),s.gender="male"===_.val("gender")?"M":"female"===_.val("gender")?"F":"W",s.smoking=null===_.val("smoker")?"W":_.val("smoker")?"Y":"N",s.pay_year=r.val("pay_year"),s.insured_category=_.val("insured_category"),s.insured_status=_.val("insured_status"),s.job_cate=_.val("job_class"),s.period=12*r.val("coverage"),s.premium_year=r.val("premium_term"),s.year=u,s=it["default"].extend(s,i);var v=o[d],c=st.toKey(d,v._meta,s);if(c in v)return st.toRow(v._meta._cols,v[c])}return{}}function M(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=it["default"].has(i,"product_id")?i.product_id:r.val("product_id"),o=r.val("product_data",u,{pid:l}),d="model_factor";if(d in o){var s={};s.charge_type=e.val("prem_freq"),s.model_type=1,s=it["default"].extend(s,i);var _=o[d],m=st.toKey(d,_._meta,s);if(m in _){var f=st.toRow(_._meta._cols,_[m]);return f}}return{}}function O(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=it["default"].has(i,"product_id")?i.product_id:r.val("product_id"),o=r.val("product_data",u,{pid:l}),d="product_unit_rate";if(d in o){var s=it["default"].clone(i),_=o[d],m=st.toKey(d,_._meta,s);if(m in _){var f=st.toRow(_._meta._cols,_[m]);return f}}return{}}function k(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=it["default"].has(i,"product_id")?i.product_id:r.val("product_id"),o=r.val("product_data",u,{pid:l}),d=o.product_allowables.coverage_terms[0],s=[];return it["default"].forEach(d,function(t){s.push({period:t[0],year:t[1]})}),s}function Y(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=it["default"].has(i,"product_id")?i.product_id:r.val("product_id"),o=r.val("product_data",u,{pid:l}),d=o.product_allowables.premium_terms[0],s=[];return it["default"].forEach(d,function(t){s.push({period:t[0],year:t[1]})}),s}function j(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=it["default"].has(i,"product_id")?i.product_id:r.val("product_id"),o=r.val("product_data",u,{pid:l}),d=o.product_allowables.payment_freq[0],s=[];return it["default"].forEach(d,function(t){s.push(t[0])}),s}function T(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=it["default"].has(i,"product_id")?i.product_id:r.val("product_id"),o=r.val("product_data",u,{pid:l}),d=o.product_allowables.attachable_riders,s=d[0],_=d[2],m=void 0,f=it["default"].map(s,function(t){return m={},it["default"].forEach(t,function(t,e){m[_[e]]=t}),m});return f}function E(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"0":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=it["default"].has(i,"product_id")?i.product_id:r.val("product_id"),o=r.val("product_data",u,{pid:l}),d="liability_config";if(d in o){var s={liab_id:301};s=it["default"].extend(s,i);var _=o[d],m=st.toKey(d,_._meta,s);if(m in _){var f=st.toRow(_._meta._cols,_[m]);return f}}return{}}function N(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"0":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=it["default"].has(i,"product_id")?i.product_id:r.val("product_id"),o=r.val("product_data",u,{pid:l}),d="pay_liability";if(d in o){var s={liab_id:301,month:12*u};s=it["default"].extend(s,i);var _=o[d],m=st.toKey(d,_._meta,s,!1);if(m in _){var f=st.toRow(_._meta._cols,_[m]);return f}}return{}}function C(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"0":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=it["default"].has(i,"product_id")?i.product_id:r.val("product_id"),o=r.val("product_data",u,{pid:l}),d="sa_schedule";if(d in o){var s={policy_year:u};s=it["default"].extend(s,i);var _=o[d],m=st.toKey(d,_._meta,s,!1);if(m in _){var f=st.toRow(_._meta._cols,_[m]);return f}}return{}}function P(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"0":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=it["default"].has(i,"product_id")?i.product_id:r.val("product_id"),o=r.val("product_data",u,{pid:l}),d="lien_rate";if(d in o){var s={age:r.val("age_at_t",u)};s=it["default"].extend(s,i);var _=o[d],m=st.toKey(d,_._meta,s);if(m in _)return st.toRow(_._meta._cols,_[m])}return{}}function I(t,e,a,r,n){var u=(arguments.length<=5||void 0===arguments[5]?"*":arguments[5],arguments.length<=6||void 0===arguments[6]?{}:arguments[6],r.val("product_data")),i=u.product_life,l=i._meta._cols,o=[];return it["default"].forOwn(i,function(t,e){if("_meta"!==e){var a=st.toRow(l,t);a.product_id=it["default"].parseInt(e),"1"===a.ins_type&&o.push(a)}}),o}function A(t,e,a,r,n){var u=(arguments.length<=5||void 0===arguments[5]?"*":arguments[5],arguments.length<=6||void 0===arguments[6]?{}:arguments[6],r.val("product_data")),i=u.fund,l=[];return i&&!function(){var t=i._meta._cols;it["default"].forOwn(i,function(e,a){if("_meta"!==a){var r=st.toRow(t,e);r.fund_code=a,l.push(r)}})}(),l}function D(t,e,a,r,n){var u=(arguments.length<=5||void 0===arguments[5]?"*":arguments[5],arguments.length<=6||void 0===arguments[6]?{}:arguments[6],r.val("product_data")),i=u.product_fund,l=i._meta._cols,o=[];return it["default"].forOwn(i,function(t,e){if("_meta"!==e){var a=st.toRow(l,t);a.fund_code=e.split(":")[1],o.push(a)}}),o}function R(t,e,a,r,n){var u=(arguments.length<=5||void 0===arguments[5]?"*":arguments[5],arguments.length<=6||void 0===arguments[6]?{}:arguments[6],r.val("product_data")),i=u.product_life,l=i._meta._cols,o=[];return it["default"].forOwn(i,function(t,e){if("_meta"!==e){var a=st.toRow(l,t);a.product_id=it["default"].parseInt(e),"2"===a.ins_type&&o.push(a)}}),o}function q(t,e,a,r,n){var u=(arguments.length<=5||void 0===arguments[5]?"*":arguments[5],arguments.length<=6||void 0===arguments[6]?{}:arguments[6]),i=it["default"].has(u,"rider_id")?u.rider_id:r.val("product_id"),l=r.val("product_data"),o=l.rider_groups[i];return o?o.mex:[]}function L(t,e,a,r,n){var u=(arguments.length<=5||void 0===arguments[5]?"*":arguments[5],arguments.length<=6||void 0===arguments[6]?{}:arguments[6]),i=it["default"].has(u,"rider_id")?u.rider_id:r.val("product_id"),l=r.val("product_data"),o=l.rider_groups[i];return o?o.deps:[]}function S(t,e,a,r,n){var u=(arguments.length<=5||void 0===arguments[5]?"*":arguments[5],arguments.length<=6||void 0===arguments[6]?{}:arguments[6]),i=it["default"].has(u,"rider_id")?u.rider_id:r.val("product_id"),l=r.val("product_data"),o=l.rider_groups[i];return o?o.sa_limit:[]}function K(t,e,a,r,n,u,i,l){var o=it["default"].has(l,"product_id")?l.product_id:n.val("product_id"),d=n.val("product_data",i,{pid:o});if(t in d){var s=d[t],_=st.toKey(t,s._meta,l);if(_ in s){var m=st.toRow(s._meta._cols,s[_]);return m}}return{}}function V(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=a[r.val("la")],o=l.val("gender").toLowerCase(),d=it["default"].extend({gender:"male"===o?"M":"female"===o?"F":"W",age:r.val("age_at_t",u)},i);return K("insurance_charge_rate",t,e,a,r,n,u,d)}function U(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6];return W(t,e,a,r,n,u,it["default"].extend(i,{type:"LOW"}))}function H(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6];return W(t,e,a,r,n,u,it["default"].extend(i,{type:"MID"}))}function B(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6];return W(t,e,a,r,n,u,it["default"].extend(i,{type:"HIGH"}))}function W(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=it["default"].extend({},i);return K("investment_performance",t,e,a,r,n,u,l)}function G(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=it["default"].extend({policy_year:u,charge_type:e.val("prem_freq"),discount_type:0},i);return K("policy_fee_ilp_default",t,e,a,r,n,u,l)}function X(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6];return J(t,e,a,r,n,u,it["default"].extend({prem_type:4},i))}function z(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6];return J(t,e,a,r,n,u,it["default"].extend({prem_type:2},i))}function $(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6];return J(t,e,a,r,n,u,it["default"].extend({prem_type:3},i))}function Q(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6];return J(t,e,a,r,n,u,it["default"].extend({prem_type:1},i))}function J(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=it["default"].extend({policy_year:u},i);return K("expense_fee_default",t,e,a,r,n,u,l)}function Z(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=a[r.val("la")],o=l.val("gender").toLowerCase(),d=it["default"].extend({period:u,job_class:l.val("job_class"),gender:"male"===o?"M":"female"===o?"F":"W",age:r.val("age_at_t",u)},i);return K("premium_rateaccident",t,e,a,r,n,u,d)}function tt(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=a[r.val("la")],o=l.val("gender").toLowerCase(),d=it["default"].extend({job_class:l.val("job_class"),gender:"male"===o?"M":"female"===o?"F":"W",age:r.val("age_at_t",u),benefit_level:r.val("benefit_level",u,i).level,effective_date:(0,ot["default"])(e.val("proposal_start_date"),["D-M-YYYY","YYYY-M-D","D-M-YYYY HH:mm:ss","YYYY-M-D HH:mm:ss"]).format("YYYY-MM-DD")},i);return K("premium_ratereimbursement",t,e,a,r,n,u,d)}function et(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=it["default"].extend({sa:r.val("initial_sa")},i);return K("benefit_plan_level",t,e,a,r,n,u,l)}function at(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=it["default"].extend({year:u},i);return K("inflation_rate",t,e,a,r,n,u,l)}function rt(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=a[r.val("la")],o=l.val("gender").toLowerCase(),d=e.val("proposal_start_date"),s=it["default"].extend({gender:"male"===o?"M":"female"===o?"F":"W",age:r.val("age_at_t",u),effective_date:(0,ot["default"])(d,["D-M-YYYY","YYYY-M-D","D-M-YYYY HH:mm:ss","YYYY-M-D HH:mm:ss"]).format("YYYY-MM-DD"),benefit_level:r.val("benefit_level",u,i).level||null},i);return K("premium_ratecash_benefit",t,e,a,r,n,u,s)}function nt(t,e,a,r,n){var u=arguments.length<=5||void 0===arguments[5]?"*":arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6],l=a[r.val("la")],o=l.val("gender").toLowerCase(),d=(e.val("proposal_start_date"),it["default"].extend({gender:"male"===o?"M":"female"===o?"F":"W",age:r.val("entry_age"),payment_frequency:e.val("prem_freq")},i));return K("allowed_multiple_times_of_target_premium_unit_link",t,e,a,r,n,u,d)}Object.defineProperty(a,"__esModule",{value:!0}),a.product_data=i,a.product_life=o,a.sa_unit_rate=d,a.tdc_rate_a=_,a.tdc_rate_b=m,a.tdc_rate_c=f,a.lsad_rate=v,a.premium_rate=g,a.age_limit=p,a.main_rider_age_limit=h,a.main_rider_sa_limit=y,a.rider_rider_sa_limit=b,a.sa_limit=w,a.premium_limit=x,a.cash_value=F,a.modal_factor=M,a.unit_rate=O,a.coverage_terms=k,a.premium_terms=Y,a.payment_freqs=j,a.attachable_riders=T,a.sb_config=E,a.sb_pay=N,a.sa_schedule=C,a.lien_rate=P,a.get_main_plans=I,a.funds=A,a.product_funds=D,a.get_riders=R,a.mutually_exclusive_riders=q,a.dependent_riders=L,a.sa_limit_groups=S,a.coi_rate=V,a.fund_low_rate=U,a.fund_mid_rate=H,a.fund_high_rate=B,a.ilp_pol_fee_rate=G,a.atu_expense_fee=X,a.tp_expense_fee=z,a.rtu_expense_fee=$,a.sp_expense_fee=Q,a.premium_rateaccident=Z,a.premium_ratereimbursement=tt,a.benefit_level=et,a.inflation_rate=at,a.premium_ratecash_benefit=rt,a.min_max_sa_multiple=nt;var ut=r(1),it=u(ut),lt=r(2),ot=u(lt),dt=r(3),st=n(dt)},function(t,e,a){(function(t){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e["default"]=t,e}function n(t){return t&&t.__esModule?t:{"default":t}}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,a,r){return a&&t(e.prototype,a),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0}),e.CONFIGS=e.DB=e.Context=e.Entity=e.Field=e.Validator=void 0;var l=a(1),o=n(l),d=a(2),s=(n(d),a(7)),_=r(s),m=a(12),f=r(m),v=a(16),c=r(v),g=window||t||root,p=o["default"].keys(g).filter(function(t){return t.indexOf("product_")>=0}).filter(function(t){return o["default"].isPlainObject(g[t])&&o["default"].has(g[t],"product_id")}),h={},y={},b=void 0,w=void 0;o["default"].forEach(p,function(t){w=parseInt(t.split("_")[1]),b=g[t],y[w]=b.config,h[w]={};var e=o["default"].keys(b.code),a=o["default"].keys(f),r=e.concat(a);r=o["default"].uniq(r),o["default"].forEach(r,function(t){o["default"].has(b.code,t)?h[w][t]=b.code[t]:h[w][t]=f[t]})});var x=function(){function t(e,a,r){var n=this;u(this,t);var i=o["default"].isUndefined(r.parentType)?"":r.parentType,l=o["default"].isUndefined(r.parent)?null:r.parent,d=o["default"].isUndefined(r.inputField)?!1:r.inputField,s=o["default"].isUndefined(r.dbField)?!1:r.dbField,_=o["default"].isUndefined(r.fmlaField)?!1:r.fmlaField,m=o["default"].isUndefined(r.value)?void 0:r.value;this.ctx=e,this.fname=a,this.parentType=i,this.parent=l,this.inputField=d,this.dbField=s,this.fmlaField=_,this.format1=o["default"].isUndefined(r.format1)?null:r.format1,this.format2=o["default"].isUndefined(r.format1)?null:r.format2;var f=void 0;null===m?f={"*":null}:o["default"].isArray(m)?(f={},o["default"].forEach(m,function(t,e){f[e+1]=t})):f={"*":m},this.values=f,this.resolved={},o["default"].forOwn(f,function(t,e){n.resolved[e]=o["default"].isUndefined(t)?!1:!0})}return i(t,[{key:"setValue",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?"*":arguments[1];this.values[e]=t,this.resolved[e]=o["default"].isUndefined(t)?!1:!0,this.resolved[e]&&"*"!==e&&"*"in this.values&&(this.resolved["*"]=!1)}},{key:"reset",value:function(){var t="*";this.values[t]=void 0,this.resolved[t]=!1}},{key:"getValue",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=0;
0!==t&&(a=t?t:"*");var r=o["default"].extend({},e),n=null;return n=this.resolved[a]?this.values[a]:this.inputField&&this.resolved["*"]?this.values["*"]:this.resolve(a,r)}},{key:"resolve",value:function(t,e){var a=this.ctx.get("policy"),r=this.ctx.get("people"),n=this.ctx.get("main"),u=this.ctx.get("product"),i=void 0;"fund"===this.parentType&&(i=this.ctx.get("fund")),"fund"===this.parentType?(u=this.ctx.get("main"),i=this.parent):"product"===this.parentType&&this.parent?u=this.parent:"people"===this.parentType&&this.parent?r=this.parent:"policy"===this.parentType&&this.parent&&(a=this.parent),u||(u=n),"product_id"in e||o["default"].isUndefined(u)||(e.product_id=u.val("product_id")),"policy_year"in e||!o["default"].isNumber(t)||(e.policy_year=t);var l=0;e.product_id?l=e.product_id:u&&u.val("product_id")?l=u.val("product_id"):"product"===this.parentType&&this.parent&&this.parent.product_id&&(l=this.parent.product_id);var d=o["default"].keys(h[l]),s=void 0;if(o["default"].includes(d,this.fname)){var _=h[l][this.fname];s=_(this.ctx,a,r,u,i,t,e)}else s=this.resolveFormula(a,r,u,i,t,e);var m=0;return m=0===t?0:t?t:"*",this.setValue(s,m),s}},{key:"resolveFormula",value:function(t,e,a,r,n,u){var i=void 0;i="policy"===this.parentType?this.ctx.get("main"):a;var l=u.product_id?u.product_id:a.val("product_id"),d=y[l],s=null;if(this.fname in d){var m=d[this.fname];if(o["default"].isArray(m)&&(m=m[0]),s=_[m],o["default"].isNull(s))throw Error("Exception in class Field, unable to load formula "+this.fname+" product "+l);try{return s(this.ctx,t,e,a,r,n,u)}catch(f){throw console.log("ERROR:",f),f}}}}]),t}(),F=function(){function t(e,a,r){var n=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];u(this,t),this.fieldMap=n,this.ctx=e,this.entityType=a,this.product_id=r,this.validatorList={}}return i(t,[{key:"getFields",value:function(){return this.fieldMap}},{key:"getField",value:function(t){if(t in this.fieldMap)return this.fieldMap[t];var e=y[this.product_id],a=o["default"].keys(e),r=o["default"].keys(h[this.product_id]);if(o["default"].includes(r,t)){var n=new x(this.ctx,t,{parentType:this.entityType,parent:this,dbField:!0});return this.fieldMap[t]=n,n}if(o["default"].includes(a,t)){var u=void 0,i=void 0,l=void 0;o["default"].has(e,t)&&(l=e[t],o["default"].isArray(l)&&(u=l[1],i=l[2]));var n=new x(this.ctx,t,{parentType:this.entityType,parent:this,fmlaField:!0,format1:u,format2:i});return this.fieldMap[t]=n,n}var n=new x(this.ctx,t,{parentType:this.entityType,parent:this,inputField:!0,value:null});return this.fieldMap[t]=n,n}},{key:"val",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?"*":arguments[1],a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=this.getField(t,a),n=void 0;if(r){if(!(r instanceof x))return r;n=r.getValue(e,a)}return n}},{key:"input",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?"*":arguments[1],a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=this.getField(t,a),n=void 0;if(r){if(!r.inputField)throw Error("Not an inputfield : "+t);n=r.getValue(e,a)}else n=r;return n}},{key:"fmval",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?"*":arguments[1],a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=this.getField(t,a),n=void 0;if(r){if(!r.fmlaField)throw Error("Not an calculator field : "+t);n=r.getValue(e,a)}else n=r;return n}},{key:"dbval",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?"*":arguments[1],a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=this.getField(t,a),n=void 0;if(r){if(!r.dbField)throw Error("Not an db field : "+t);n=r.getValue(e,a)}else n=r;return n}},{key:"db0",value:function(t,e){var a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return this.dbval(t,e,a)[0]}},{key:"db1",value:function(t,e){var a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return this.dbval(t,e,a)[1]}},{key:"db2",value:function(t,e){var a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return this.dbval(t,e,a)[2]}},{key:"db3",value:function(t,e){var a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return this.dbval(t,e,a)[3]}},{key:"db4",value:function(t,e){var a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return this.dbval(t,e,a)[4]}},{key:"db5",value:function(t,e){var a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return this.dbval(t,e,a)[5]}},{key:"db6",value:function(t,e){var a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return this.dbval(t,e,a)[6]}},{key:"db7",value:function(t,e){var a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return this.dbval(t,e,a)[7]}},{key:"db8",value:function(t,e){var a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return this.dbval(t,e,a)[8]}},{key:"db9",value:function(t,e){var a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return this.dbval(t,e,a)[9]}},{key:"setField",value:function(t,e){this.fieldMap[t]=e}},{key:"validate",value:function(t,e){var a=void 0;t in this.validatorList?a=this.validatorList[t]:(a=new O(this.product_id,t,this,this.ctx,o["default"].extend({},e)),this.validatorList[t]=a);var r=a.validate();return o["default"].isArray(r)||(r=[r]),r=o["default"].filter(r,function(t){return!o["default"].isUndefined(t)}),r=o["default"].flatten(r)}},{key:"check",value:function(t,e){return this.validate(t,e)}}]),t}(),M=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];u(this,t),this.data=e}return i(t,[{key:"exists",value:function(t){return t in this.data}},{key:"get",value:function(t){return this.data[t]}},{key:"set",value:function(t,e){this.data[t]=e}}]),t}(),O=e.Validator=function(){function t(e,a,r,n,i){u(this,t),this.productId=e,this.validatorName=a,this.parent=r,this.ctx=n,this.opts=i,this.config=y[e].validators}return i(t,[{key:"validate",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=this.validatorName in this.config?this.config[this.validatorName]:null,a=e?c[e]:null;return a?a(this.ctx,this.parent,t):"Unable to locate validator : "+this.validatorName}}]),t}();e.Field=x,e.Entity=F,e.Context=M,e.DB=h,e.CONFIGS=y}).call(e,function(){return this}())},function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function n(t){return Math.ceil(2*t)/2}function u(t){return f["default"].round(t,2)}function i(t){return f["default"].ceil(t,2)}function l(t){return f["default"].floor(t,2)}function o(t){return f["default"].round(t,0)}function d(t){return f["default"].ceil(t,0)}function s(t){return f["default"].floor(t,0)}function _(t){return f["default"].round(t/1e3,0)}Object.defineProperty(e,"__esModule",{value:!0}),e.round_50cents=n,e.round_cents_half_up=u,e.round_cents_up=i,e.round_cents_down=l,e.round_dollar_half_up=o,e.round_dollar_up=d,e.round_dollar_down=s,e.round_thousand_half_up=_;var m=a(1),f=r(m)},function(t,e){"use strict";function a(t,e,a){var r=[],n=0,u=t.get("main").val("funds");return _.forEach(u,function(t,e){n+=100*t.val("allocation"),r.push(t.validate("check_fund_allocation")),r.push(t.validate("check_min_fund_allocation"))}),100!==n&&r.push("Combined funds allocation must be 100%"),r}function r(t,e,a){var r=100*e.val("allocation");return r%5!==0?"Fund ("+e.val("fund_code")+") allocation must be multiples of 5%":void 0}function n(t,e,a){var r=100*e.val("allocation");return 10>r?"Fund ("+e.val("fund_code")+") allocation must at least be 10%":void 0}Object.defineProperty(e,"__esModule",{value:!0}),e.validate_funds_alloc__01=a,e.check_fund_allocation__01=r,e.check_min_fund_allocation__01=n},function(t,e,a){"use strict";function r(t,e,a){}Object.defineProperty(e,"__esModule",{value:!0}),e.noop=r;var n=a(18),u=function(t){return"default"===t?"continue":void Object.defineProperty(e,t,{enumerable:!0,get:function(){return n[t]}})};for(var i in n){u(i)}var l=a(15),o=function(t){return"default"===t?"continue":void Object.defineProperty(e,t,{enumerable:!0,get:function(){return l[t]}})};for(var d in l){o(d)}var s=a(19),_=function(t){return"default"===t?"continue":void Object.defineProperty(e,t,{enumerable:!0,get:function(){return s[t]}})};for(var m in s){_(m)}var f=a(20),v=function(t){return"default"===t?"continue":void Object.defineProperty(e,t,{enumerable:!0,get:function(){return f[t]}})};for(var c in f){v(c)}var g=a(17),p=function(t){return"default"===t?"continue":void Object.defineProperty(e,t,{enumerable:!0,get:function(){return g[t]}})};for(var h in g){p(h)}e.FIXME="FIXME"},function(t,e){"use strict"},function(t,e){"use strict";function a(t,e,a){var r=[];return r.push(e.validate("check_sa_limit",a)),r.push(e.validate("check_age_limit",a)),r}function r(t,e,a){var r=[];return r.push(e.validate("check_sa_limit",a)),r.push(e.validate("check_sa_multiple",a)),r.push(e.validate("check_age_limit",a)),r.push(e.validate("check_ilp_tp_limit",a)),r.push(e.validate("check_ilp_rtu_limit",a)),r.push(e.validate("check_ilp_min_rtu",a)),r}function n(t,e,a){var r=t.get("policy"),n=r.val("products"),u=n.length>1?n.slice(1):[],i=[];return _.forEach(u,function(t){i.push(t.validate("validate_rider",{}))}),i}function u(t,e,a){var r=[];return r.push(e.validate("check_sa_limit",a)),r.push(e.validate("check_age_limit",a)),r.push(e.validate("check_sa_multiple",a)),r}function i(t,e,a){var r=[];return r.push(e.validate("check_sa_limit",a)),r.push(e.validate("check_age_limit",a)),r.push(e.validate("check_min_max_sa_units",a)),r}function l(t,e,a){var r=e,n=r.val("sa_limit"),u=r.val("initial_sa")||r.val("sa_calculated");return u<n.insd_min_amount?"The sum assured is less than the minimum required for this product":u>n.insd_max_amount?"The sum assured is more than the maximum allowed for this product":void 0}function o(t,e,a){var r=e.val("entry_age"),n=e.val("target_premium"),u=e.db0("min_max_sa_multiple"),i=e.db1("min_max_sa_multiple"),l=e.db0("modal_factor"),o=e.fmval("sa_calculated"),d=void 0,s=void 0,_=void 0;return d=r>=6&&17>=r?Math.min(3e8,i*n*l):i*n*l,s=u*n*l,_=o>d?"Sum Assured is larger than the allowed maxiumum":s>o?"Sum Assured is smaller than the allowed minimum":void 0}function d(t,e,a){var r=t.get("main"),n=e.val("sa_calculated"),u=5,i=r.val("sa_calculated"),l=i*u;return n>l?"Sum assured is more than the allowed maximum : "+l:void 0}function s(t,e,a){var r=e.val("entry_age"),n=t.get("policy"),u=n.val("people"),i=u[e.val("la")],l=moment(i.val("dob"),["D-M-YYYY","YYYY-M-D"]),o=moment(n.val("proposal_start_date"),["D-M-YYYY","YYYY-M-D"]),d=moment.duration(o.diff(l)).asMonths(),s=e.val("initial_sa"),_=0;return _=0>d||r>61?0:5>r?5:61>=r?10:0,s>_?"The number of units is more than the allowed maximum ":void 0}function m(t,e,a){var r=e,n=r.val("entry_age"),u=r.val("age_limit");return"1"===u.min_insd_nb_age_unit&&n<u.min_insd_nb_age?"The insured age is less than the required minimum age for this product":"1"===u.max_insd_nb_age_unit&&n>u.max_insd_nb_age?"The insured is older than the allowed maximum age for this product":void 0}function f(t,e,a){var r=e,n=r.val("premium_limit"),u=r.val("target_premium");return u<n.min_initial_prem?"The target premium is less than the minimum required for this product":u>n.max_initial_prem?"The target premium is more than the maximum allowed for this product":void 0}function v(t,e,a){var r=e,n=(r.val("premium_limit"),r.val("rtu"));return 5e5>n?"The regular topup is less than the minimum required for this product":void 0}function c(t,e,a){var r=e.val("target_premium"),n=e.val("modal_factor").charge_rate,u=e.val("rtu"),i=u+r*n,l=u/i*100,o=[50,100,200,350,500,99999999999],d=[0,10,20,30,40,50],s=void 0,m=void 0;return s=_.filter(o,function(t){return 1e6*t>i}),m=0===s.length?50:d[o.indexOf(s[0])],m>l?"RTU amount is less than the required min ratio to the annual premium":void 0}Object.defineProperty(e,"__esModule",{value:!0}),e.validate_main__01=a,e.validate_main__02=r,e.validate_all_riders__01=n,e.validate_rider__01=u,e.validate_rider__02=i,e.check_sa_limit__01=l,e.check_sa_multiple__01=o,e.check_sa_multiple__02=d,e.check_min_max_sa_units__01=s,e.check_age_limit__01=m,e.check_ilp_tp_limit__01=f,e.check_ilp_rtu_limit__01=v,e.check_ilp_min_rtu__01=c},function(t,e){"use strict"},function(t,e){"use strict"}])});